1.  create database

CREATE DATABASE DataTransformer;

2.  create customer tables

CREATE TABLE Customers (
    CustomerID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Email VARCHAR(100),
    RegistrationDate DATE
);


3. insert values into customers


INSERT INTO Customers VALUES
(1, 'John', 'Doe', '  john.doe@email.com ', '2022-03-15'),
(2, 'Jane', 'Smith', 'jane.smith@email.com', '2021-11-02');


4. CREATE ORDER TABLES

CREATE TABLE Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT,
    OrderDate DATE,
    TotalAmount DECIMAL(10,2),
    FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID)
);

5.  insert values into order tables

INSERT INTO Orders VALUES
(101, 1, '2023-07-01', 150.50),
(102, 2, '2023-07-03', 200.75);


6.  employees tables

CREATE TABLE Employees (
    EmployeeID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Department VARCHAR(50),
    HireDate DATE,
    Salary DECIMAL(10,2)
);


7. insert into employee tables

INSERT INTO Employees VALUES
(1, 'Mark', 'Johnson', 'Sales', '2020-01-15', 50000),
(2, 'Susan', 'Lee', 'HR', '2021-03-20', 55000);


***quries to perform***

1.  JOIN
-INNER JOIN-

SELECT o.OrderID, c.FirstName, c.LastName, o.TotalAmount
FROM Orders o
INNER JOIN Customers c ON o.CustomerID = c.CustomerID;

-LEFT JOIN-

SELECT c.FirstName, c.LastName, o.OrderID
FROM Customers c
LEFT JOIN Orders o ON c.CustomerID = o.CustomerID;

-RIGHT JOIN-

SELECT o.OrderID, c.FirstName
FROM Customers c
RIGHT JOIN Orders o ON c.CustomerID = o.CustomerID;

++FULL OUTER JOIN++

SELECT c.CustomerID, o.OrderID
FROM Customers c
LEFT JOIN Orders o ON c.CustomerID = o.CustomerID
UNION
SELECT c.CustomerID, o.OrderID
FROM Customers c
RIGHT JOIN Orders o ON c.CustomerID = o.CustomerID;


**Customer with order above average amount**

SELECT *
FROM Customers
WHERE CustomerID IN (
    SELECT CustomerID
    FROM Orders
    WHERE TotalAmount > (SELECT AVG(TotalAmount) FROM Orders)
);


---Employee with salaries above average amount---

SELECT *
FROM Employees
WHERE Salary > (SELECT AVG(Salary) FROM Employees);


****EXTRACT THE YEAR AND MONTH FROM THE AVERAGE SALARY****

SELECT OrderID,
       YEAR(OrderDate) AS OrderYear,
       MONTH(OrderDate) AS OrderMonth
FROM Orders;


****Difference between order date & current date****

SELECT OrderID,
       DATEDIFF(CURDATE(), OrderDate) AS DaysDifference
FROM Orders;


****formate the order date****


SELECT OrderID,
       DATE_FORMAT(OrderDate, '%d-%b-%Y') AS FormattedDate
FROM Orders;


**** join the first name and last name ****


SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Customers;


****replace the string****

SELECT REPLACE(FirstName, 'John', 'Jonathan') AS UpdatedName
FROM Customers;


**** convert the first name in uppercase & last name  in lower case****

SELECT UPPER(FirstName) AS FirstName_Upper,
       LOWER(LastName) AS LastName_Lower
FROM Customers;


****Trim extra space from mail ID****

SELECT TRIM(Email) AS CleanEmail
FROM Customers;



****total amount of each order****

SELECT OrderID,
       OrderDate,
       TotalAmount,
       SUM(TotalAmount) OVER (ORDER BY OrderDate) AS RunningTotal
FROM Orders;


****ranking on-order amount****

SELECT OrderID,
       TotalAmount,
       RANK() OVER (ORDER BY TotalAmount DESC) AS OrderRank
FROM Orders;


***assign discount based on amount***

SELECT OrderID,
       TotalAmount,
       CASE
           WHEN TotalAmount > 1000 THEN '10% Discount'
           WHEN TotalAmount > 500 THEN '5% Discount'
           ELSE 'No Discount'
       END AS Discount
FROM Orders;


***Categorize employee salary as high,medium,low***

SELECT EmployeeID,
       Salary,
       CASE
           WHEN Salary >= 60000 THEN 'High'
           WHEN Salary >= 50000 THEN 'Medium'
           ELSE 'Low'
       END AS SalaryCategory
FROM Employees;


















 